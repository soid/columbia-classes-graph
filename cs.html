<!DOCTYPE>

<html>

<head>
	<title>cytoscape-popper.js demo</title>

	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
	<script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/dagre@0.7.4/dist/dagre.js"></script>
    <script src="cytoscape-dagre.js"></script>

	<!-- for testing with local version of cytoscape.js -->
	<!--<script src="../cytoscape.js/build/cytoscape.js"></script>-->

  <script src="https://unpkg.com/popper.js@1.14.7/dist/umd/popper.js"></script>
	<script src="cytoscape-popper.js"></script>
    <script src="data/cs-data.js"></script>

	<style>
		body {
			font-family: helvetica neue, helvetica, liberation sans, arial, sans-serif;
			font-size: 14px
		}

		#cy {
			position: absolute;
			left: 0;
			top: 10em;
			bottom: 0;
			right: 0;
			z-index: 1;
		}

		h1 {
			opacity: 0.5;
			font-size: 1em;
			font-weight: bold;
		}

		.popper-div { /* just an example */
			border: 1px solid red;
			background: #fff;
			z-index: 9999;
			padding: 0.25em;
			pointer-events: none;
		}
	</style>

	<script>
		document.addEventListener('DOMContentLoaded', function () {

            var id2node = {};
            for (var i=0; i<elements.nodes.length; i++) {
                id2node[elements.nodes[i].data.id] = elements.nodes[i];
            }

			var cy = window.cy = cytoscape({
				container: document.getElementById('cy'),

                layout: {
                    name: 'breadthfirst',
//                    spacingFactor: 3.5,
                    maximal: true,
                    directed: true,
/*                    fit: false,
                    rankSep: 100,
                    nodeSep: 150,
                    padding: 100,*/
//                    ranker: 'tight-tree'
                  },

				style: [
					{
						selector: 'node',
						style: {
							'content': 'data(id)',
                            'background-color': 'data(color)',
                            'color': 'black'
						}
					},
					{
						selector: 'edge',
						style: {
							'curve-style': 'bezier',
							'target-arrow-shape': 'triangle',
                            'width': 1
						}
					}
				],
                elements: elements
			});

            cy.on('mouseover', 'node', function(node) {
                var data = node.target.data();
                document.getElementById('course-descr').innerHTML = data.id + ": " + data.title;
                node.target.animate({
                    style: {
                      borderColor: "#2D3142",
                      borderWidth: 3
                    }
                });
            });
            cy.on('mouseout', 'node', function(node) {
                var data = node.target.data();
                document.getElementById('course-descr').innerHTML = "";
                node.target.animate({
                    style: {
                      borderColor: "#ABC4AB",
                      borderWidth: 0
                    }
                  }, {
                    duration: 200
                  });
            });


            var cb = document.getElementById('showUnscheduled');
            var showUnscheduledClick = function(checked) {
                cy.nodes().forEach(function (node) {
                    if (!checked && !node.data()['scheduled']) {
                        node.hide();
                    } else {
                        node.show();
                    }
                })
            };
            showUnscheduledClick(false);

            cb.addEventListener('click', function (e) { showUnscheduledClick(e.target.checked) });
		});
	</script>
</head>

<body>
	<h1>Columbia University Courses Map</h1>
    <div>
        <input type="checkbox" id="showUnscheduled">
        <label for="showUnscheduled">Show unscheduled classes</label>
    </div>
    <div id="course-descr"></div>
	<div id="cy"></div>
</body>

</html>



